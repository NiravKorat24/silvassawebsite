<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project Details</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header class="header">
  <div class="logo">
    <img src="assets/Silvassa-Group-Surat-525x328.png" alt="SILVASSA GROUP">
  </div>
  <nav>
    <a href="index.html">Home</a>
    <a href="index.html#properties">Properties</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<section class="property-detail">
  <div id="details"></div>
</section>

<!-- Lightbox -->
 
<div id="lightbox" onclick="closeLightbox()">
  <img id="lightbox-img" alt="">
</div>

<!-- Sticky Enquiry -->
<a id="stickyEnquire" href="#" onclick="openStickyEnquiry()">Enquire Now</a>

<script>
const id = new URLSearchParams(window.location.search).get("id");
let galleryImages = [];
let currentIndex = 0;
let currentProperty = {};

fetch("sites.json")
.then(res => res.json())
.then(data => {
  const site = data.find(p => String(p.id) === String(id));
  if (!site) return;

  currentProperty = site;
  galleryImages = site.gallery || [site.image];

  const whatsappMessage = encodeURIComponent(
    `Hello, I am interested in the following property:%0A` +
    `Name: ${site.name}%0A` +
    `Size: ${site.size}%0A%0A` +
    `Please share more information.`
  );

  document.getElementById("details").innerHTML = `
  <div class="detail-card">

    <!-- GALLERY -->
    <div class="detail-gallery">
      <div class="gallery-main">
        <button class="gallery-arrow left" onclick="changeImage(-1)">❮</button>
        <img id="mainImage" src="${galleryImages[0]}" onclick="openLightbox(this.src)">
        <button class="gallery-arrow right" onclick="changeImage(1)">❯</button>
      </div>

      <div class="gallery-thumbs-wrapper">
        <button class="thumb-arrow" onclick="slideThumbs(-1)">❮</button>
        <div class="gallery-thumbs" id="thumbContainer">
          ${galleryImages.map((img,i)=>`<img src="${img}" onclick="setImage(${i})">`).join("")}
        </div>
        <button class="thumb-arrow" onclick="slideThumbs(1)">❯</button>
      </div>
    </div>

    <!-- CONTENT -->
    <div class="detail-content">
      <div class="title-row">
  <h2>${site.name}</h2>
  <span class="status-badge ${site.status}">
    ${
      site.status === "completed"
        ? "Completed"
        : site.status === "ongoing"
        ? "Ongoing"
        : "New Launch"

    }
  </span>
</div>
      <div class="detail-meta">
        <p><span>Type</span>${site.type || "-"}</p>
        <p><span>Size</span>${site.size || "-"}</p>
        <p><span>Location</span>${site.location || "-"}</p>
        <p><span>ADDRESS</span>${site.address || "-"}</p>
      </div>

      <div class="detail-desc">
        <h4>About This Property</h4>
        <p>${site.description}</p>
      </div>

${site.highlights ? `
<div class="info-block">
  <h4>Key Highlights</h4>
  <ul>
    ${site.highlights.map(h=>`<li>${h}</li>`).join("")}
  </ul>
</div>` : ""}

${site.amenities ? `
<div class="info-block">
  <h4>Amenities</h4>
  <ul class="amenities-list">
    ${site.amenities.map(a=>`<li><span class="amenity-icon"></span>${a}</li>`).join("")}
  </ul>
</div>` : ""}

${site.connectivity ? `
<div class="info-block">
  <h4>Connectivity</h4>
  <ul class="connectivity-list">
    ${site.connectivity.map(a=>`<li><span class="connectivity-icon"></span>${a}</li>`).join("")}
  </ul>
</div>` : ""}

${site.floorPlans ? `
<div class="info-block">
  <h4>Floor Plans</h4>
  <div class="floor-plans">
    ${site.floorPlans.map(img=>`<img src="${img}" onclick="openLightbox(this.src)">`).join("")}
  </div>
</div>` : ""}


      <div class="map-embed">
        <iframe src="${site.mapEmbed}" loading="lazy"></iframe>
      </div>

      <div class="contact-actions">
  <a class="whatsapp-btn"
     href="https://wa.me/7990521795?text=${whatsappMessage}"
     target="_blank">
    Enquire on WhatsApp
  </a>

  <a class="call-btn" href="tel:7990521795">
    Call Now
  </a>
</div>


  </div>`;
});

/* Gallery */
function setImage(i){currentIndex=i;mainImage.src=galleryImages[i];}
function changeImage(s){currentIndex=(currentIndex+s+galleryImages.length)%galleryImages.length;setImage(currentIndex);}
function slideThumbs(s){thumbContainer.scrollLeft+=s*120;}
function openLightbox(src) {
  const img = document.getElementById("lightbox-img");
  img.src = "";
  setTimeout(() => {
    img.src = src;
    document.getElementById("lightbox").style.display = "flex";
  }, 10);
}

function closeLightbox(){lightbox.style.display="none";}

/* Sticky enquiry */
function openStickyEnquiry(){
  const msg = encodeURIComponent(
    `Hello, I am interested in the following property:%0A` +
    `Name: ${currentProperty.name || ""}%0A` +
    `Size: ${currentProperty.size || ""}%0A%0A` +
    `Please share more information.`
  );
  window.open(`https://wa.me/7990521795?text=${msg}`,"_blank");
}
</script>

</body>
</html>
